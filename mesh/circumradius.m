function R = circumradius(V,T)
  % CIRCUMRADIUS Return the circumradius of each tet element
  % 
  % R = circumradius(V,T)
  %
  % Input:
  %   V  #V by 3 list of vertex positions
  %   T  #T by 4 list of tet indices
  % Output:
  %   R  #T by 4 list of tet cicrumradii
  
  d_14 = sqrt(sum((V(T(:,1),:)-V(T(:,4),:)).^2,2));
  d_23 = sqrt(sum((V(T(:,2),:)-V(T(:,3),:)).^2,2));
  d_24 = sqrt(sum((V(T(:,2),:)-V(T(:,4),:)).^2,2));
  d_34 = sqrt(sum((V(T(:,3),:)-V(T(:,4),:)).^2,2));
  d_12 = sqrt(sum((V(T(:,1),:)-V(T(:,2),:)).^2,2));
  d_13 = sqrt(sum((V(T(:,1),:)-V(T(:,3),:)).^2,2));
  R = sqrt((d_14.*d_23+d_13.*d_24-d_12.*d_34).*(d_14.*d_23-d_13.*d_24+d_12.*d_34).*(-d_14.*d_23+d_13.*d_24+d_12.*d_34).*(d_14.*d_23+d_13.*d_24+d_12.*d_34))./(sqrt(2)*sqrt(-2.*d_34.^2.*d_12.^4-2.*d_34.^4.*d_12.^2-2.*d_13.^2.*d_23.^2.*d_12.^2+2.*d_14.^2.*d_23.^2.*d_12.^2+2.*d_13.^2.*d_24.^2.*d_12.^2-2.*d_14.^2.*d_24.^2.*d_12.^2+2.*d_13.^2.*d_34.^2.*d_12.^2+2.*d_14.^2.*d_34.^2.*d_12.^2+2.*d_23.^2.*d_34.^2.*d_12.^2+2.*d_24.^2.*d_34.^2.*d_12.^2-2.*d_14.^2.*d_23.^4-2.*d_13.^2.*d_24.^4-2.*d_14.^4.*d_23.^2+2.*d_13.^2.*d_14.^2.*d_23.^2-2.*d_13.^4.*d_24.^2+2.*d_13.^2.*d_14.^2.*d_24.^2+2.*d_13.^2.*d_23.^2.*d_24.^2+2.*d_14.^2.*d_23.^2.*d_24.^2-2.*d_13.^2.*d_14.^2.*d_34.^2+2.*d_14.^2.*d_23.^2.*d_34.^2+2.*d_13.^2.*d_24.^2.*d_34.^2-2.*d_23.^2.*d_24.^2.*d_34.^2));

end
